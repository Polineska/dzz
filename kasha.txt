каша из топора с ошибками
 Не выделено, где какой вид алгоритма использовался.

 В отдельных моментах потерялась логика про "попробовать" 