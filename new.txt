каша исправлена
 выделено, где какой вид алгоритма использовался.

 логика про "попробовать" 